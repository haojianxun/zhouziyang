(function(p){var q=new Array,r=new Array,s=function(){},t=0;var u={splashVPos:"35%",loaderVPos:"52%",splashID:"#jpreContent",showSplash:true,showPercentage:true,autoClose:true,closeBtnText:"Start!",onetimeLoad:false,debugMode:false,splashFunction:function(){}};var v=function(){if(u.onetimeLoad){var d=document.cookie.split("; ");for(var e=0,f;f=d[e]&&d[e].split("=");e++){if(f.shift()==="jpreLoader"){return f.join("=")}}return false}else{return false}};var w=function(d){if(u.onetimeLoad){var e=new Date;e.setDate(e.getDate()+d);var f=d==null?"":"expires="+e.toUTCString();document.cookie="jpreLoader=loaded; "+f}};var x=function(){jOverlay=p("<div></div>").attr("id","jpreOverlay").css({position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:9999999}).appendTo("body");if(u.showSplash){jContent=p("<div></div>").attr("id","jpreSlide").appendTo(jOverlay);var a=p(window).width()-p(jContent).width();p(jContent).css({position:"absolute",top:u.splashVPos,left:Math.round(50/p(window).width()*a)+"%"});p(jContent).html(p(u.splashID).wrap("<div/>").parent().html());p(u.splashID).remove();u.splashFunction()}jLoader=p("<div></div>").attr("id","jpreLoader").appendTo(jOverlay);var d=p(window).width()-p(jLoader).width();p(jLoader).css({position:"absolute",top:u.loaderVPos,left:Math.round(50/p(window).width()*d)+"%"});jBar=p("<div></div>").attr("id","jpreBar").css({width:"0%",height:"100%"}).appendTo(jLoader);if(u.showPercentage){jPer=p("<div></div>").attr("id","jprePercentage").css({position:"relative",height:"100%"}).appendTo(jLoader).html("Loading...")}if(!u.autoclose){jButton=p("<div></div>").attr("id","jpreButton").on("click",function(){C()}).css({position:"relative",height:"100%"}).appendTo(jLoader).text(u.closeBtnText).hide()}};var y=function(a){p(a).find("*:not(script)").each(function(){var b="";if(p(this).css("background-image").indexOf("none")==-1&&p(this).css("background-image").indexOf("-gradient")==-1){b=p(this).css("background-image");if(b.indexOf("url")!=-1){var e=b.match(/url\((.*?)\)/);b=e[1].replace(/\"/g,"")}}else{if(p(this).get(0).nodeName.toLowerCase()=="img"&&typeof p(this).attr("src")!="undefined"){b=p(this).attr("src")}}if(b.length>0){q.push(b)}})};var z=function(){for(var b=0;b<q.length;b++){if(A(q[b])){}}};var A=function(a){var c=new Image;p(c).load(function(){B()}).error(function(){r.push(p(this).attr("src"));B()}).attr("src",a)};var B=function(){t++;var a=Math.round(t/q.length*100);p(jBar).stop().animate({width:a+"%"},500,"linear");if(u.showPercentage){p(jPer).text(a+"%")}if(t>=q.length){t=q.length;w();if(u.showPercentage){p(jPer).text("100%")}if(u.debugMode){var b=D()}p(jBar).stop().animate({width:"100%"},500,"linear",function(){if(u.autoClose){C()}else{p(jButton).fadeIn(1000)}})}};var C=function(){p(jOverlay).fadeOut(800,function(){p(jOverlay).remove();s()})};var D=function(){if(r.length>0){var c="ERROR - IMAGE FILES MISSING!!!\n\r";c+=r.length+" image files cound not be found. \n\r";c+="Please check your image paths and filenames:\n\r";for(var d=0;d<r.length;d++){c+="- "+r[d]+"\n\r"}return true}else{return false}};p.fn.jpreLoader=function(a,d){if(a){p.extend(u,a)}if(typeof d=="function"){s=d}p("body").css({display:"block"});return this.each(function(){if(!v()){x();y(this);z()}else{p(u.splashID).remove();s()}})}})(jQuery);