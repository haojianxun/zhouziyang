!function(p,q,r,s){function D(a,d){this.element=a,this.options=p.extend({},u,d),this._defaults=u,this._name=t,this.init()}var t="stellar",u={scrollProperty:"scroll",positionProperty:"position",horizontalScrolling:!0,verticalScrolling:!0,horizontalOffset:0,verticalOffset:0,responsive:!1,parallaxBackgrounds:!0,parallaxElements:!0,hideDistantElements:!0,hideElement:function(b){b.hide()},showElement:function(b){b.show()}},v={scroll:{getLeft:function(b){return b.scrollLeft()},setLeft:function(c,d){c.scrollLeft(d)},getTop:function(b){return b.scrollTop()},setTop:function(c,d){c.scrollTop(d)}},position:{getLeft:function(b){return parseInt(b.css("left"),10)*-1},getTop:function(b){return parseInt(b.css("top"),10)*-1}},margin:{getLeft:function(b){return parseInt(b.css("margin-left"),10)*-1},getTop:function(b){return parseInt(b.css("margin-top"),10)*-1}},transform:{getLeft:function(c){var d=getComputedStyle(c[0])[y];return"none"!==d?parseInt(d.match(/(-?[0-9]+)/g)[4],10)*-1:0},getTop:function(c){var d=getComputedStyle(c[0])[y];return"none"!==d?parseInt(d.match(/(-?[0-9]+)/g)[5],10)*-1:0}}},w={position:{setLeft:function(c,d){c.css("left",d)},setTop:function(c,d){c.css("top",d)}},transform:{setPosition:function(f,g,h,i,j){f[0].style[y]="translate3d("+(g-h)+"px, "+(i-j)+"px, 0)"}}},x=function(){var h,a=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,f=p("script")[0].style,g="";for(h in f){if(a.test(h)){g=h.match(a)[0];break}}return"WebkitOpacity" in f&&(g="Webkit"),"KhtmlOpacity" in f&&(g="Khtml"),function(b){return g+(g.length>0?b.charAt(0).toUpperCase()+b.slice(1):b)}}(),y=x("transform"),z=p("<div />",{style:"background:#fff"}).css("background-position-x")!==s,A=z?function(d,e,f){d.css({"background-position-x":e,"background-position-y":f})}:function(d,e,f){d.css("background-position",e+" "+f)},B=z?function(b){return[b.css("background-position-x"),b.css("background-position-y")]}:function(b){return b.css("background-position").split(" ")},C=q.requestAnimationFrame||q.webkitRequestAnimationFrame||q.mozRequestAnimationFrame||q.oRequestAnimationFrame||q.msRequestAnimationFrame||function(b){setTimeout(b,1000/60)};D.prototype={init:function(){this.options.name=t+"_"+Math.floor(1000000000*Math.random()),this._defineElements(),this._defineGetters(),this._defineSetters(),this._handleWindowLoadAndResize(),this._detectViewport(),this.refresh({firstLoad:!0}),"scroll"===this.options.scrollProperty?this._handleScrollEvent():this._startAnimationLoop()},_defineElements:function(){this.element===r.body&&(this.element=q),this.$scrollElement=p(this.element),this.$element=this.element===q?p("body"):this.$scrollElement,this.$viewportElement=this.options.viewportElement!==s?p(this.options.viewportElement):this.$scrollElement[0]===q||"scroll"===this.options.scrollProperty?this.$scrollElement:this.$scrollElement.parent()},_defineGetters:function(){var c=this,d=v[c.options.scrollProperty];this._getScrollLeft=function(){return d.getLeft(c.$scrollElement)},this._getScrollTop=function(){return d.getTop(c.$scrollElement)}},_defineSetters:function(){var a=this,g=v[a.options.scrollProperty],h=w[a.options.positionProperty],i=g.setLeft,j=g.setTop;this._setScrollLeft="function"==typeof i?function(b){i(a.$scrollElement,b)}:p.noop,this._setScrollTop="function"==typeof j?function(b){j(a.$scrollElement,b)}:p.noop,this._setPosition=h.setPosition||function(b,d,k,l,m){a.options.horizontalScrolling&&h.setLeft(b,d,k),a.options.verticalScrolling&&h.setTop(b,l,m)}},_handleWindowLoadAndResize:function(){var a=this,b=p(q);a.options.responsive&&b.bind("load."+this.name,function(){a.refresh()}),b.bind("resize."+this.name,function(){a._detectViewport(),a.options.responsive&&a.refresh()})},refresh:function(a){var b=this,g=b._getScrollLeft(),h=b._getScrollTop();a&&a.firstLoad||this._reset(),this._setScrollLeft(0),this._setScrollTop(0),this._setOffsets(),this._findParticles(),this._findBackgrounds(),a&&a.firstLoad&&/WebKit/.test(navigator.userAgent)&&p(q).load(function(){var c=b._getScrollLeft(),d=b._getScrollTop();b._setScrollLeft(c+1),b._setScrollTop(d+1),b._setScrollLeft(c),b._setScrollTop(d)}),this._setScrollLeft(g),this._setScrollTop(h)},_detectViewport:function(){var c=this.$viewportElement.offset(),d=null!==c&&c!==s;this.viewportWidth=this.$viewportElement.width(),this.viewportHeight=this.$viewportElement.height(),this.viewportOffsetTop=d?c.top:0,this.viewportOffsetLeft=d?c.left:0},_findParticles:function(){var a=this;this._getScrollLeft(),this._getScrollTop();if(this.particles!==s){for(var c=this.particles.length-1;c>=0;c--){this.particles[c].$element.data("stellar-elementIsActive",s)}}this.particles=[],this.options.parallaxElements&&this.$element.find("[data-stellar-ratio]").each(function(b){var E,F,G,H,I,J,K,L,M,d=p(this),N=0,O=0,P=0,Q=0;if(d.data("stellar-elementIsActive")){if(d.data("stellar-elementIsActive")!==this){return}}else{d.data("stellar-elementIsActive",this)}a.options.showElement(d),d.data("stellar-startingLeft")?(d.css("left",d.data("stellar-startingLeft")),d.css("top",d.data("stellar-startingTop"))):(d.data("stellar-startingLeft",d.css("left")),d.data("stellar-startingTop",d.css("top"))),G=d.position().left,H=d.position().top,I="auto"===d.css("margin-left")?0:parseInt(d.css("margin-left"),10),J="auto"===d.css("margin-top")?0:parseInt(d.css("margin-top"),10),L=d.offset().left-I,M=d.offset().top-J,d.parents().each(function(){var e=p(this);return e.data("stellar-offset-parent")===!0?(N=P,O=Q,K=e,!1):(P+=e.position().left,void (Q+=e.position().top))}),E=d.data("stellar-horizontal-offset")!==s?d.data("stellar-horizontal-offset"):K!==s&&K.data("stellar-horizontal-offset")!==s?K.data("stellar-horizontal-offset"):a.horizontalOffset,F=d.data("stellar-vertical-offset")!==s?d.data("stellar-vertical-offset"):K!==s&&K.data("stellar-vertical-offset")!==s?K.data("stellar-vertical-offset"):a.verticalOffset,a.particles.push({$element:d,$offsetParent:K,isFixed:"fixed"===d.css("position"),horizontalOffset:E,verticalOffset:F,startingPositionLeft:G,startingPositionTop:H,startingOffsetLeft:L,startingOffsetTop:M,parentOffsetLeft:N,parentOffsetTop:O,stellarRatio:d.data("stellar-ratio")!==s?d.data("stellar-ratio"):1,width:d.outerWidth(!0),height:d.outerHeight(!0),isHidden:!1})})},_findBackgrounds:function(){var h,a=this,d=this._getScrollLeft(),g=this._getScrollTop();this.backgrounds=[],this.options.parallaxBackgrounds&&(h=this.$element.find("[data-stellar-background-ratio]"),this.$element.data("stellar-background-ratio")&&(h=h.add(this.$element)),h.each(function(){var e,j,k,l,m,E,F,b=p(this),c=B(b),G=0,H=0,I=0,J=0;if(b.data("stellar-backgroundIsActive")){if(b.data("stellar-backgroundIsActive")!==this){return}}else{b.data("stellar-backgroundIsActive",this)}b.data("stellar-backgroundStartingLeft")?A(b,b.data("stellar-backgroundStartingLeft"),b.data("stellar-backgroundStartingTop")):(b.data("stellar-backgroundStartingLeft",c[0]),b.data("stellar-backgroundStartingTop",c[1])),k="auto"===b.css("margin-left")?0:parseInt(b.css("margin-left"),10),l="auto"===b.css("margin-top")?0:parseInt(b.css("margin-top"),10),m=b.offset().left-k-d,E=b.offset().top-l-g,b.parents().each(function(){var f=p(this);return f.data("stellar-offset-parent")===!0?(G=I,H=J,F=f,!1):(I+=f.position().left,void (J+=f.position().top))}),e=b.data("stellar-horizontal-offset")!==s?b.data("stellar-horizontal-offset"):F!==s&&F.data("stellar-horizontal-offset")!==s?F.data("stellar-horizontal-offset"):a.horizontalOffset,j=b.data("stellar-vertical-offset")!==s?b.data("stellar-vertical-offset"):F!==s&&F.data("stellar-vertical-offset")!==s?F.data("stellar-vertical-offset"):a.verticalOffset,a.backgrounds.push({$element:b,$offsetParent:F,isFixed:"fixed"===b.css("background-attachment"),horizontalOffset:e,verticalOffset:j,startingValueLeft:c[0],startingValueTop:c[1],startingBackgroundPositionLeft:isNaN(parseInt(c[0],10))||-1!==c[0].indexOf("%")?0:parseInt(c[0],10),startingBackgroundPositionTop:isNaN(parseInt(c[1],10))||-1!==c[1].indexOf("%")?0:parseInt(c[1],10),startingPositionLeft:b.position().left,startingPositionTop:b.position().top,startingOffsetLeft:m,startingOffsetTop:E,parentOffsetLeft:G,parentOffsetTop:H,stellarRatio:b.data("stellar-background-ratio")===s?1:b.data("stellar-background-ratio")})}))},_reset:function(){var f,g,h,i,j;for(j=this.particles.length-1;j>=0;j--){f=this.particles[j],g=f.$element.data("stellar-startingLeft"),h=f.$element.data("stellar-startingTop"),this._setPosition(f.$element,g,g,h,h),this.options.showElement(f.$element),f.$element.data("stellar-startingLeft",null).data("stellar-elementIsActive",null).data("stellar-backgroundIsActive",null)}for(j=this.backgrounds.length-1;j>=0;j--){i=this.backgrounds[j],i.$element.data("stellar-backgroundStartingLeft",null).data("stellar-backgroundStartingTop",null),A(i.$element,i.startingValueLeft,i.startingValueTop)}},destroy:function(){this._reset(),this.$scrollElement.unbind("resize."+this.name).unbind("scroll."+this.name),this._animationLoop=p.noop,p(q).unbind("load."+this.name).unbind("resize."+this.name)},_setOffsets:function(){var a=this,b=p(q);b.unbind("resize.horizontal-"+this.name).unbind("resize.vertical-"+this.name),"function"==typeof this.options.horizontalOffset?(this.horizontalOffset=this.options.horizontalOffset(),b.bind("resize.horizontal-"+this.name,function(){a.horizontalOffset=a.options.horizontalOffset()})):this.horizontalOffset=this.options.horizontalOffset,"function"==typeof this.options.verticalOffset?(this.verticalOffset=this.options.verticalOffset(),b.bind("resize.vertical-"+this.name,function(){a.verticalOffset=a.options.verticalOffset()})):this.verticalOffset=this.options.verticalOffset},_repositionElements:function(){var l,E,F,G,H,K,L,M,N,O,c=this._getScrollLeft(),d=this._getScrollTop(),I=!0,J=!0;if(this.currentScrollLeft!==c||this.currentScrollTop!==d||this.currentWidth!==this.viewportWidth||this.currentHeight!==this.viewportHeight){for(this.currentScrollLeft=c,this.currentScrollTop=d,this.currentWidth=this.viewportWidth,this.currentHeight=this.viewportHeight,O=this.particles.length-1;O>=0;O--){l=this.particles[O],E=l.isFixed?1:0,this.options.horizontalScrolling?(K=(c+l.horizontalOffset+this.viewportOffsetLeft+l.startingPositionLeft-l.startingOffsetLeft+l.parentOffsetLeft)*-(l.stellarRatio+E-1)+l.startingPositionLeft,M=K-l.startingPositionLeft+l.startingOffsetLeft):(K=l.startingPositionLeft,M=l.startingOffsetLeft),this.options.verticalScrolling?(L=(d+l.verticalOffset+this.viewportOffsetTop+l.startingPositionTop-l.startingOffsetTop+l.parentOffsetTop)*-(l.stellarRatio+E-1)+l.startingPositionTop,N=L-l.startingPositionTop+l.startingOffsetTop):(L=l.startingPositionTop,N=l.startingOffsetTop),this.options.hideDistantElements&&(J=!this.options.horizontalScrolling||M+l.width>(l.isFixed?0:c)&&M<(l.isFixed?0:c)+this.viewportWidth+this.viewportOffsetLeft,I=!this.options.verticalScrolling||N+l.height>(l.isFixed?0:d)&&N<(l.isFixed?0:d)+this.viewportHeight+this.viewportOffsetTop),J&&I?(l.isHidden&&(this.options.showElement(l.$element),l.isHidden=!1),this._setPosition(l.$element,K,l.startingPositionLeft,L,l.startingPositionTop)):l.isHidden||(this.options.hideElement(l.$element),l.isHidden=!0)}for(O=this.backgrounds.length-1;O>=0;O--){F=this.backgrounds[O],E=F.isFixed?0:1,G=this.options.horizontalScrolling?(c+F.horizontalOffset-this.viewportOffsetLeft-F.startingOffsetLeft+F.parentOffsetLeft-F.startingBackgroundPositionLeft)*(E-F.stellarRatio)+"px":F.startingValueLeft,H=this.options.verticalScrolling?(d+F.verticalOffset-this.viewportOffsetTop-F.startingOffsetTop+F.parentOffsetTop-F.startingBackgroundPositionTop)*(E-F.stellarRatio)+"px":F.startingValueTop,A(F.$element,G,H)}}},_handleScrollEvent:function(){var e=this,f=!1,g=function(){e._repositionElements(),f=!1},h=function(){f||(C(g),f=!0)};this.$scrollElement.bind("scroll."+this.name,h),h()},_startAnimationLoop:function(){var b=this;this._animationLoop=function(){C(b._animationLoop),b._repositionElements()},this._animationLoop()}},p.fn[t]=function(a){var d=arguments;return a===s||"object"==typeof a?this.each(function(){p.data(this,"plugin_"+t)||p.data(this,"plugin_"+t,new D(this,a))}):"string"==typeof a&&"_"!==a[0]&&"init"!==a?this.each(function(){var b=p.data(this,"plugin_"+t);b instanceof D&&"function"==typeof b[a]&&b[a].apply(b,Array.prototype.slice.call(d,1)),"destroy"===a&&p.data(this,"plugin_"+t,null)}):void 0},p[t]=function(a){var b=p(q);return b.stellar.apply(b,Array.prototype.slice.call(arguments,0))},p[t].scrollProperty=v,p[t].positionProperty=w,q.Stellar=D}(jQuery,this,document);